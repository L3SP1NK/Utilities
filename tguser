#!/bin/bash
## Verify if a Telegram user exist.
## Currently reporting false positive (name with only numbers and/or containing special characters).

## Set colors.
BOLD="\e[1m"
GREEN="\e[32m"
RED="\e[31m"
BLUE="\e[34m"

WARN="${RED}${BOLD} [-]${RC}"
INFO="${BLUE}${BOLD} [*]${RC}"
GOOD="${GREEN}${BOLD} [+]${RC}"

REQUIREMENTS="curl"
TG_LINK="https://t.me/"
TG_USER="${1}"

DISPLAY_HELP()
{
	echo -e "${CYAN}${ITALIC}Check if a Telegram username is valid.\n"
	echo -e "${UNDERLINE}Usage:"
	echo -e " ./tguser <username>\n"
}

REQUEST=$(curl -sf "${TG_LINK}/${TG_USER}" | grep "og:description")
NO_DESCRIPTION='<meta property="og:description" content="">'

CHECK_USER()
{
	## Check if the user have a descritption (Telegram automatically add one if the user don't).
	if [[ ${REQUEST} != ${NO_DESCRIPTION} ]]
		then
			echo -e "${GREEN} [+] User ${TG_USER} found!"
		else
			echo -e "${WARN} [-] User ${TG_USER} not found!"
	fi
}

which ${REQUIREMENTS}>/dev/null

if [[ ${?} -eq "0" ]]
	then
		if [[ ${1} ]]
			then
				CHECK_USER
			else
				DISPLAY_HELP
		fi
	else
		echo -e "${WARN} To run this program, you need the following packages installed: ${REQUIREMENTS}\nExiting..."
		exit 1
fi
